---
import { getCollection, render } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { site } from '../../consts/site';

export async function getStaticPaths() {
	const projects = await getCollection('projects');
	return projects.map((project) => ({ params: { slug: project.slug }, props: { project } }));
}

const { project } = Astro.props;
const { Content } = await render(project);
---

<BaseLayout title={`${project.data.title} | ${site.name}`}>
	<article class="container article">
		<p><a class="back" href="/projects">Back to projects</a></p>
		<header>
			<span class="chip">{project.data.tags.join(' Â· ')}</span>
			<h1>{project.data.title}</h1>
			<p class="muted">{project.data.summary}</p>
		</header>

		<div class="links">
			{project.data.liveUrl && (
				<a href={project.data.liveUrl} target="_blank" rel="noreferrer">
					View Live
				</a>
			)}
			{project.data.repoUrl && (
				<a href={project.data.repoUrl} target="_blank" rel="noreferrer">
					View Code
				</a>
			)}
		</div>

		<div class="content">
			<Content />
		</div>
	</article>
</BaseLayout>

<style>
	.article {
		padding-top: var(--space-12);
		max-width: 52rem;
	}

	h1 {
		font-family: var(--font-display);
		font-size: clamp(1.8rem, 1.4rem + 1.8vw, 3rem);
		line-height: 1.05;
		margin: var(--space-4) 0 var(--space-2);
	}

	.back {
		color: var(--accent-strong);
		font-weight: 600;
	}

	.links {
		display: flex;
		gap: 1rem;
		margin: var(--space-6) 0;
	}

	.links a {
		padding: 0.3rem 0.7rem;
		border: 1px solid var(--line);
		border-radius: 999px;
	}

	.links a:hover,
	.links a:focus-visible {
		color: var(--accent-strong);
		border-color: color-mix(in oklab, var(--accent) 45%, var(--line));
	}

	.content :global(p),
	.content :global(li) {
		color: var(--ink);
	}
</style>
